<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core" xmlns:forgeview="http://jboss.org/forge/view"
	xmlns:rich="http://richfaces.org/rich" xmlns:a4j="http://richfaces.org/a4j"
	xmlns:p="http://xmlns.jcp.org/jsf/passthrough" template="/resources/scaffold/pageTemplate.xhtml">

	<ui:param name="pageTitle" value="Create Booking" />

	<ui:define name="header">
		Buchungen
	</ui:define>

	<ui:define name="subheader">
		Buchungen erstellen
	</ui:define>

	<ui:define name="footer" />

	<ui:define name="main">

		<h:form id="createBookings">
			<rich:collapsiblePanel header="Trupps Buchen Auf Aktivität" switchType="ajax"
				expanded="#{createBookingsBean.squadBookingVisible}" immediate="true">
				<h:messages styleClass="error" />
				<h:panelGrid columnClasses="label,component,required" columns="3">

					<h:outputLabel for="createBookingsBeanBookingActivity" value="Aktivität:" />
					<h:panelGroup>
						<h:selectOneListbox id="createBookingsBeanBookingActivity" value="#{createBookingsBean.activity}"
							converter="#{activityBean.converter}" required="true">
							<f:selectItems value="#{activityBean.active}" var="item" itemLabel="#{item.name}" itemValue="#{item.idStr}" />
						</h:selectOneListbox>
					</h:panelGroup>
					<h:message for="createBookingsBeanBookingActivity" styleClass="error" />

					<h:outputLabel for="createBookingsBeanBookingSquads" value="Trupp:" />
					<h:panelGroup>
						<h:selectManyListbox id="createBookingsBeanBookingSquads" value="#{createBookingsBean.squads}"
							converter="#{squadBean.converter}" required="true" size="4">
							<f:selectItems value="#{squadBean.all}" var="item" itemLabel="#{item.name}" itemValue="#{item.idStr}" />
						</h:selectManyListbox>
					</h:panelGroup>
					<h:message for="createBookingsBeanBookingSquads" styleClass="error" />

					<h:outputLabel for="createBookingsBeanBookingWithAssistants" value="Mit Assistenten:" />
					<h:selectBooleanCheckbox id="createBookingsBeanBookingWithAssistants" value="#{createBookingsBean.withAssistants}" />
					<h:message for="createBookingsBeanBookingWithAssistants" styleClass="error" />

					<h:outputLabel value="Buchung durchführen:" />
					<h:commandButton id="createBookingsBeanCreateBookings" action="#{createBookingsBean.createBookings()}" value="Buchen"
						disabled="#{!bookingBean.updateAllowed}" />
					<h:messages for="createBookingsBeanCreateBookings" />

				</h:panelGrid>
			</rich:collapsiblePanel>
		</h:form>

		<h:form id="createBookingsForAllActive">
			<rich:collapsiblePanel header="Alle Aktiven Auf Aktivität Buchen" switchType="ajax"
				expanded="#{createBookingsBean.allBookingVisible}" immediate="true">
				<h:messages styleClass="error" />
				<h:panelGrid columnClasses="label,component,required" columns="3">

					<h:outputLabel for="createBookingsBeanBookingActivityAllActive" value="Aktivität:" />
					<h:panelGroup>
						<h:selectOneListbox id="createBookingsBeanBookingActivityAllActive" value="#{createBookingsBean.activity}"
							converter="#{activityBean.converter}" required="true">
							<f:selectItems value="#{activityBean.active}" var="item" itemLabel="#{item.name}" itemValue="#{item.idStr}" />
						</h:selectOneListbox>
					</h:panelGroup>
					<h:message for="createBookingsBeanBookingActivityAllActive" styleClass="error" />

					<h:outputLabel value="Buchung durchführen:" />
					<h:commandButton id="createBookingsBeanCreateBookingsAllActive" action="#{createBookingsBean.createBookingsForAllActive()}"
						value="Alle Aktiven Pfadfinder Buchen" disabled="#{!bookingBean.createAllAllowed}" />
					<h:messages for="createBookingsBeanCreateBookingsAllActive" />

				</h:panelGrid>
			</rich:collapsiblePanel>
		</h:form>

		<h:form id="createBookingsFromSource">
			<rich:collapsiblePanel header="Neu Buchen Von/Auf Aktivität" switchType="ajax"
				expanded="#{createBookingsBean.fromToVisible}" immediate="true">
				<h:messages styleClass="error" />
				<h:panelGrid columnClasses="label,component,required" columns="3">

					<h:outputLabel for="createBookingsBeanBookingActivitySource" value="Quell-Aktivität:" />
					<h:panelGroup>
						<h:selectOneListbox id="createBookingsBeanBookingActivitySource" value="#{createBookingsBean.sourceActivity}"
							converter="#{activityBean.converter}" required="true">
							<f:selectItems value="#{activityBean.all}" var="item" itemLabel="#{item.name}" itemValue="#{item.idStr}" />
							<f:ajax render="createBookingsFromSource" />
						</h:selectOneListbox>
					</h:panelGroup>
					<h:message for="createBookingsBeanBookingActivitySource" styleClass="error" />

					<h:outputLabel for="createBookingsBeanBookingActivityTarget" value="Ziel-Aktivität:" />
					<h:panelGroup>
						<h:selectOneListbox id="createBookingsBeanBookingActivityTarget" value="#{createBookingsBean.targetActivity}"
							converter="#{activityBean.converter}" required="true">
							<f:selectItems value="#{activityBean.active}" var="item" itemLabel="#{item.name}" itemValue="#{item.idStr}" />
							<f:ajax render="createBookingsFromSource" />
						</h:selectOneListbox>
					</h:panelGroup>
					<h:message for="createBookingsBeanBookingActivityTarget" styleClass="error" />

					<h:outputLabel value="Buchung Neu:" />
					<h:commandButton id="createBookingsBeanCreateBookingsSource" action="#{createBookingsBean.createBookingsFromSource()}"
						value="Von #{createBookingsBean.sourceActivity.name} auf #{createBookingsBean.targetActivity.name} Neu Buchen"
						disabled="#{!bookingBean.createAllAllowed}"
						rendered="#{createBookingsBean.sourceActivity != null and createBookingsBean.targetActivity != null}" />
					<h:messages for="createBookingsBeanCreateBookingsSource" />

				</h:panelGrid>
			</rich:collapsiblePanel>
		</h:form>

	</ui:define>

</ui:composition>